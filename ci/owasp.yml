steps:

  - task: dependency-check-build-task@6
    displayName: 'OWASP Dependency Check scan of third-party dependencies' # This task will perform security scan of third-party dependencies
    inputs:
      projectName: 'angularApp'
      scanPath: '$(Build.SourcesDirectory)'
      failOnCVSS: 100 # Fail the build if vulnerabilities with CVSS score higher than 8 are discovered
      #format: 'HTML, JUNIT' # Format of scan result report
      format: 'ALL'
      #suppressionPath: '$(Build.SourcesDirectory)/suppression-file.xml' # File where all the suppressed vulnerabilities are defined
      enableExperimental: true # Enable experimental file type analyzers
      additionalArguments: '--scan $(Build.SourcesDirectory)' # Additional folder to scan
      dependencyCheckVersion: '7.1.2'
      continueOnError: true

  - task: PublishTestResults@2
    displayName: 'Publish OWASP Dependency Check security scan results'
    inputs:
      testResultsFormat: 'HTML'
      testResultsFiles: 'dependency-check-report.html'
      #testResultsFiles: 'dependency-check-junit.xml'
      #searchFolder: '$(Common.TestResultsDirectory)'
      searchFolder: '/home/vsts/work/1/TestResults/dependency-check/'
      #searchFolder: '/home/vsts/work/1/TestResults/dependency-check/dependency-check-report.html'
      testRunTitle: 'Dependency Check'
      #buildConfiguration: '$(BuildConfiguration)'
