steps:
      - script: |
          docker pull owasp/zap2docker-stable    
        displayName: Pull owasp/zap2docker-stable docker image
 
      - script: |
          chmod -R 777  ./
          docker run -v $(pwd):/zap/wrk/:rw -t owasp/zap2docker-stable zap-full-scan.py \
             -t http://dev-korio.eastus.cloudapp.azure.com/ -g gen.conf -r testreport.html
          pwd
          ls -al
        
        displayName: OWASP ZAP Scan
        continueOnError: true
      
      - task: PublishTestResults@2
        displayName: 'Publish Test Results testreport.html'
        inputs:
          testResultsFormat: NUnit
          testResultsFiles: 'zap/wrk/testreport.html'

      - task: CopyFiles@2
        displayName: 'Copy Files to: $(Build.ArtifactStagingDirectory)'
        inputs:
          SourceFolder: /zap/wrk
          TargetFolder: '$(Build.ArtifactStagingDirectory)'

      - task: PublishBuildArtifacts@1
        displayName: 'Publish Artifact: zap-scanner-reports'
        inputs:
          ArtifactName: 'zap-scanner-reports'
